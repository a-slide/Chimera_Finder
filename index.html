<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Chimera_finder by a-slide</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Chimera_finder</h1>
        <h2>BASH scripts to extract chimeric pairs and chimeric reads from NGS data mixing 2 DNA references</h2>
        <a href="https://github.com/a-slide/Chimera_Finder" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a name="welcome-to-chimera_finder-page" class="anchor" href="#welcome-to-chimera_finder-page"><span class="octicon octicon-link"></span></a>Welcome to Chimera_finder Page</h1>

<h2>
<a name="motivations" class="anchor" href="#motivations"><span class="octicon octicon-link"></span></a>Motivations</h2>

<p>Chimera_finder consist of 2 simple Bash pipelines for pair end illumina NGS data, originally dedicated to retrieval of viral insertion sites retrieval in a host cell genome (chimeric paired end and chimeric reads). Pipelines were initially designed to find Adeno associated vectors genome integrated in host cell genomic DNA, but they may also be suitable for any other viral integration sites after minor code modifications.</p>

<h2>
<a name="principle" class="anchor" href="#principle"><span class="octicon octicon-link"></span></a>Principle</h2>

<p>Data provided to both pipelines had to be generated by pair end sequencing with a recent Illumina platform (MiSeq or Hiseq). The scripts use the same basic strategy but <strong>chimera_finder_single.sh</strong> merge forward and reverse fastq read files at the very beginning of its execution and mapping is then performed in single end mode. In contrast <strong>chimera_finder_pair.sh</strong> keep pairs separated through all the process. <strong>chimera_finder_single.sh</strong> is able to extract reads that overlap host DNA and viral DNA, while <strong>chimera_finder_pair.sh</strong> identify paired reads having one read mapped on a reference and the second read mapped on a different reference.</p>

<p>Basic steps of the algorithms are detailed bellow</p>

<h3>
<a name="preprocessing" class="anchor" href="#preprocessing"><span class="octicon octicon-link"></span></a>Preprocessing</h3>

<p>Extremities of bad quality sequences are trimmed using Sickle using "pe mode" for <strong>chimera_finder_pair.sh</strong> and "se mode" for <strong>chimera_finder_single.sh</strong></p>

<h3>
<a name="subtraction-of-non-chimeric-readspairs" class="anchor" href="#subtraction-of-non-chimeric-readspairs"><span class="octicon octicon-link"></span></a>Subtraction of non-chimeric reads/pairs</h3>

<p>In order to facilitate further analyses, we first remove from dataset reads (for <strong>chimera_finder_single.sh</strong>) and read pairs (for <strong>chimera_finder_pair.sh</strong>) which map unambiguously on only one of the reference. To do so, fastq are mapped against the viral genome with the fast read aligner Bowtie2 using end to end highly stringent mapping conditions. reads/pairs with a MAPQ &gt; 30 are then removed using Samtools and a fastq dataset is regenerated with Bedtools bamtofastq. From this smaller dataset, a second round of mapping/filtering/fastq regeneration is then performed with the host cell genome.</p>

<h3>
<a name="extraction-of-chimera" class="anchor" href="#extraction-of-chimera"><span class="octicon octicon-link"></span></a>Extraction of chimera</h3>

<p><strong>chimera_finder_single.sh</strong> performs a local bowtie2 alignment against a reference index mixing both viral and genomic DNA. We used a special option of Bowtie2 (-k 5) rendering the 5 best alignments instead of only one. SAM files resulting from the alignment are parsed with standard UNIX tools (grep, sort, awk, comm and join) to select reads with map in both viral and genomic DNA. </p>

<p>As for <strong>chimera_finder_pair.sh</strong> the principle is slightly different. A standard local alignment is performed against the mixed index and SAM file is parsed to retrieve pairs with one read aligned on viral DNA and the mate on host cell DNA.</p>

<h3>
<a name="postprocessing" class="anchor" href="#postprocessing"><span class="octicon octicon-link"></span></a>Postprocessing</h3>

<p>During this last step a BAM file, a BAM index (.BAI) and a Bedgraph are produced for further visualization (with <a href="http://www.broadinstitute.org/igv/home">integrated genomic viewer</a> for example). Finally, a report containing parameters used for this run and BAMflag statistics is generated (sample_report.txt)</p>

<h2>
<a name="get-chimera_finder" class="anchor" href="#get-chimera_finder"><span class="octicon octicon-link"></span></a>Get Chimera_finder</h2>

<h3>
<a name="from-github-repository" class="anchor" href="#from-github-repository"><span class="octicon octicon-link"></span></a>From github repository</h3>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>git clone https://github.com/a-slide/Chimera_Finder my_folder/
</pre></div>

<h3>
<a name="archive-download" class="anchor" href="#archive-download"><span class="octicon octicon-link"></span></a>Archive download</h3>

<ul>
<li><a href="https://github.com/a-slide/Chimera_Finder/archive/master.zip">ZIP archive</a></li>
<li><a href="https://github.com/a-slide/Chimera_Finder/tarball/master">TAR.GZ archive</a></li>
</ul><p>In both case, scripts must be made executable using <em>chmod</em>.</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>sudo chmod u+x chimera_finder_pair.sh chimera_finder_single.sh
</pre></div>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Before using pipelines, the 3 following reference genomes must be indexed for Bowtie2 (see <a href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#the-bowtie2-build-indexer">the-bowtie2-build-indexer</a> :</p>

<ul>
<li>Viral genome alone</li>
<li>Host cell genome alone</li>
<li>Viral and host cell genome together</li>
</ul><div class="highlight highlight-bash"><pre><span class="nv">$ </span><span class="c"># For chimeric pairs extraction</span>
<span class="nv">$ </span>./ chimera_finder_single.sh 
<span class="nv">$ </span>  <span class="o">[</span> R1.fastq<span class="o">(</span>.gz<span class="o">)</span> <span class="o">]</span>
<span class="nv">$ </span>  <span class="o">[</span> R2.fastq<span class="o">(</span>.gz<span class="o">)</span> <span class="o">]</span>
<span class="nv">$ </span>  <span class="o">[</span> output name <span class="o">]</span>
<span class="nv">$ </span>  <span class="o">[</span> viral genome index<span class="o">]</span>
<span class="nv">$ </span>  <span class="o">[</span> host genome index<span class="o">]</span>
<span class="nv">$ </span>  <span class="o">[</span> viral + host genome index<span class="o">]</span>
</pre></div>

<p>Fastq files containing forward reads (R1.fastq) and reverse reads (R2.fastq) can be provide as uncompressed or tarball compressed files.</p>

<p>The output name will be used as a prefix for all files that will be generated during the analysis.</p>

<p>Indexes need to be indicated as the basename of index files up to but not including the final <em>.1.bt2</em>. For example, for the viral genome indexed file in the folder <em>my_virus_index</em> are named <em>my_virus.1.bt2</em>, <em>my_virus.2.bt2</em>, <em>my_virus.3.bt2</em>, <em>my_virus.4.bt2</em>, <em>my_virus.rev.1.bt2</em>, <em>my_virus.rev.2.bt2</em>. In this situation viral genome index will be <em>path/my_virus_index/my_virus</em>.</p>

<h3>
<a name="dependencies" class="anchor" href="#dependencies"><span class="octicon octicon-link"></span></a>Dependencies:</h3>

<p>The script was developed under Linux Mint 16 "petra" but is compatible with other LINUX debian based distributions. The following dependencies are required by the pipeline. Users should verify that all of these programs are added to PATH and correspond to the indicated or a later version.</p>

<ul>
<li>
<a href="https://www.gnu.org/software/bash/">GNU bash</a>, version 4.2.45(1)-release</li>
<li>
<a href="https://github.com/najoshi/sickle">Sickle</a> (v1.210)</li>
<li>
<a href="http://bowtie-bio.sourceforge.net/bowtie2/index.shtml">Bowtie2</a> (v2.1.0)</li>
<li>
<a href="http://samtools.sourceforge.net/">Samtools</a> (v0.1.19-96b5f2294a) </li>
<li>
<a href="https://github.com/arq5x/bedtools2/release">Bedtools</a> (v2.17.0)</li>
</ul><h2>
<a name="authors-and-contact" class="anchor" href="#authors-and-contact"><span class="octicon octicon-link"></span></a>Authors and Contact</h2>

<p>Adrien Leger <a href="https://github.com/a-slide" class="user-mention">@a-slide</a></p>

<p><a href="mailto:adrien.leger@inserm.fr">adrien.leger@inserm.fr</a></p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/a-slide/Chimera_Finder/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/a-slide/Chimera_Finder/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/a-slide/Chimera_Finder"></a> is maintained by <a href="https://github.com/a-slide">a-slide</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>